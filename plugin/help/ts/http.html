<html>
   <header>
      <title>http</title>
      <link rel="stylesheet" href="../../../PRODUCT_PLUGIN/book.css" />
   </header>
   <body>
      <h2>http</h2>

      <div class="groupDescription">HTTP protocol-specific functions.</div>
      <h3>Contents</h3>
      <ul>
         <li>
            <a href="#http.addHeader">http.addHeader</a>
         </li>
         <li>
            <a href="#http.addResponseHeader">http.addResponseHeader</a>
         </li>
         <li>
            <a href="#http.changeSite">http.changeSite</a>
         </li>
         <li>
            <a href="#http.cookie">http.cookie</a>
         </li>
         <li>
            <a href="#http.doesFormParamExist">http.doesFormParamExist</a>
         </li>
         <li>
            <a href="#http.getBody">http.getBody</a>
         </li>
         <li>
            <a href="#http.getBodyLines">http.getBodyLines</a>
         </li>
         <li>
            <a href="#http.getCookie">http.getCookie</a>
         </li>
         <li>
            <a href="#http.getCookies">http.getCookies</a>
         </li>
         <li>
            <a href="#http.getFormParam">http.getFormParam</a>
         </li>
         <li>
            <a href="#http.getFormParamNames">http.getFormParamNames</a>
         </li>
         <li>
            <a href="#http.getFormParams">http.getFormParams</a>
         </li>
         <li>
            <a href="#http.getHeader">http.getHeader</a>
         </li>
         <li>
            <a href="#http.getHeaderNames">http.getHeaderNames</a>
         </li>
         <li>
            <a href="#http.getHeaders">http.getHeaders</a>
         </li>
         <li>
            <a href="#http.getHostHeader">http.getHostHeader</a>
         </li>
         <li>
            <a href="#http.getMethod">http.getMethod</a>
         </li>
         <li>
            <a href="#http.getMultipartAttachment">http.getMultipartAttachment</a>
         </li>
         <li>
            <a href="#http.getPath">http.getPath</a>
         </li>
         <li>
            <a href="#http.getQueryString">http.getQueryString</a>
         </li>
         <li>
            <a href="#http.getRawQueryString">http.getRawQueryString</a>
         </li>
         <li>
            <a href="#http.getRawURL">http.getRawURL</a>
         </li>
         <li>
            <a href="#http.getRequest">http.getRequest</a>
         </li>
         <li>
            <a href="#http.getResponse">http.getResponse</a>
         </li>
         <li>
            <a href="#http.getResponseBody">http.getResponseBody</a>
         </li>
         <li>
            <a href="#http.getResponseBodyLines">http.getResponseBodyLines</a>
         </li>
         <li>
            <a href="#http.getResponseCode">http.getResponseCode</a>
         </li>
         <li>
            <a href="#http.getResponseCookie">http.getResponseCookie</a>
         </li>
         <li>
            <a href="#http.getResponseCookies">http.getResponseCookies</a>
         </li>
         <li>
            <a href="#http.getResponseHeader">http.getResponseHeader</a>
         </li>
         <li>
            <a href="#http.getResponseHeaderNames">http.getResponseHeaderNames</a>
         </li>
         <li>
            <a href="#http.getResponseHeaders">http.getResponseHeaders</a>
         </li>
         <li>
            <a href="#http.getResponseVersion">http.getResponseVersion</a>
         </li>
         <li>
            <a href="#http.getVersion">http.getVersion</a>
         </li>
         <li>
            <a href="#http.headerExists">http.headerExists</a>
         </li>
         <li>
            <a href="#http.listFormParamNames">http.listFormParamNames</a>
         </li>
         <li>
            <a href="#http.listHeaderNames">http.listHeaderNames</a>
         </li>
         <li>
            <a href="#http.listResponseHeaderNames">http.listResponseHeaderNames</a>
         </li>
         <li>
            <a href="#http.normalizePath">http.normalizePath</a>
         </li>
         <li>
            <a href="#http.redirect">http.redirect</a>
         </li>
         <li>
            <a href="#http.removeCookie">http.removeCookie</a>
         </li>
         <li>
            <a href="#http.removeHeader">http.removeHeader</a>
         </li>
         <li>
            <a href="#http.removeResponseCookie">http.removeResponseCookie</a>
         </li>
         <li>
            <a href="#http.removeResponseHeader">http.removeResponseHeader</a>
         </li>
         <li>
            <a href="#http.responseHeaderExists">http.responseHeaderExists</a>
         </li>
         <li>
            <a href="#http.scrubRequestHeaders">http.scrubRequestHeaders</a>
         </li>
         <li>
            <a href="#http.scrubResponseHeaders">http.scrubResponseHeaders</a>
         </li>
         <li>
            <a href="#http.sendResponse">http.sendResponse</a>
         </li>
         <li>
            <a href="#http.setBody">http.setBody</a>
         </li>
         <li>
            <a href="#http.setCookie">http.setCookie</a>
         </li>
         <li>
            <a href="#http.setEscapedPath">http.setEscapedPath</a>
         </li>
         <li>
            <a href="#http.setHeader">http.setHeader</a>
         </li>
         <li>
            <a href="#http.setIdempotent">http.setIdempotent</a>
         </li>
         <li>
            <a href="#http.setMethod">http.setMethod</a>
         </li>
         <li>
            <a href="#http.setPath">http.setPath</a>
         </li>
         <li>
            <a href="#http.setQueryString">http.setQueryString</a>
         </li>
         <li>
            <a href="#http.setRawPath">http.setRawPath</a>
         </li>
         <li>
            <a href="#http.setRawQueryString">http.setRawQueryString</a>
         </li>
         <li>
            <a href="#http.setResponseBody">http.setResponseBody</a>
         </li>
         <li>
            <a href="#http.setResponseCode">http.setResponseCode</a>
         </li>
         <li>
            <a href="#http.setResponseCookie">http.setResponseCookie</a>
         </li>
         <li>
            <a href="#http.setResponseHeader">http.setResponseHeader</a>
         </li>
      </ul>

      <h3>Function Documentation</h3>
      <div class="functionDoc" id="http.addHeader">
         <h4>http.addHeader( name, value )</h4>
         <div class="functionDescription"><p>
Modifies the current HTTP request, adding an HTTP header with the supplied value. A case-insensitive lookup is first performed in order to find any existing headers.  If a match is found, a duplicate header will be added to the message  along with the new value.
</p><pre># Add a host header if it is missing<br>if( !http.headerExists( "Host" ) ) {<br>&nbsp;&nbsp;&nbsp;http.addHeader( "Host", "unknown" );<br>}</pre><b>See also:</b> <a href="./http.html#http.setHeader">http.setHeader</a>, <a href="./http.html#http.getHeader">http.getHeader</a>, <a href="./http.html#http.removeHeader">http.removeHeader</a>, <a href="./http.html#http.headerExists">http.headerExists</a>, <a href="./http.html#http.addResponseHeader">http.addResponseHeader</a></div>
      </div>

      <div class="functionDoc" id="http.addResponseHeader">
         <h4>http.addResponseHeader( name, value )</h4>
         <div class="functionDescription"><p>
Adds an HTTP header to the HTTP response that will be sent back to the client. If the header already exists in the response, then this value will be appended to the existing value. The header lookup is case-insensitive.
</p><pre># Set a cookie to remember this user<br>http.addResponseHeader( "Set-Cookie",<br>&nbsp;&nbsp;&nbsp;"id=12345678; path=/" );</pre><b>See also:</b> <a href="./http.html#http.setResponseHeader">http.setResponseHeader</a>, <a href="./http.html#http.getResponseHeader">http.getResponseHeader</a>, <a href="./http.html#http.removeResponseHeader">http.removeResponseHeader</a>, <a href="./http.html#http.addHeader">http.addHeader</a></div>
      </div>

      <div class="functionDoc" id="http.changeSite">
         <h4>http.changeSite( name )</h4>
         <div class="functionDescription"><p>
Redirect users to a new website. It is a more sophisticated version  of http.redirect() that will preserve the original path that the  request asked for. Note that it sends back a HTTP 301 redirect rather than the 302 response returned by http.redirect().  For instance, if the original request was for "http://www.example.com/image/image.jpg", then http.changeSite( "example.co.uk" ) would redirect the user to "http://example.co.uk/image/image.jpg"  The redirection will preserve the original path (and any query string) of the request, together with the port number and protocol. If you wish to force any of these details, then you can specify them as part of the supplied host name. e.g. http.changeSite( "https://www.example.com" ) will always send people to a SSL-encrypted site.  You can also add on a prefix to the path of the URL, e.g. http.changeSite( "www.example.com/oldsite" ) would redirect a request for "http://www.example.com/missing/page.html" to "http://www.example.com/oldsite/missing/page.html".  If the original request matches the supplied redirection, then http.changeSite() will take no action and let the request continue. This ensures that no 'redirection loops' occur.
</p><pre># Send users to our new site<br>if( http.getHostHeader() == "www.zeus.com" ) {<br>&nbsp;&nbsp;&nbsp;http.changeSite( "www.brocade.com" );<br>}</pre><b>See also:</b> <a href="./http.html#http.sendResponse">http.sendResponse</a>, <a href="./http.html#http.redirect">http.redirect</a></div>
      </div>

      <div class="functionDoc" id="http.cookie">
         <h4>http.cookie( name )</h4>
         <div class="functionDescription"><p>
Returns the value of the named cookie.
</p><p>This function has been deprecated; </div>
      </div>

      <div class="functionDoc" id="http.doesFormParamExist">
         <h4>http.doesFormParamExist( Parameter )</h4>
         <div class="functionDescription"><p>
Checks whether a form parameter is present, either in the URL query string, or if not found and the request is a POST, from the POST body data. It returns 1 if the parameter is present, and 0 if not.<br/>  This is useful when there are form parameters with no value, e.g a query string like 'foo=bar&amp;stuff&amp;x=y' - the 'stuff' parameter has no value, but is present.
</p><pre># Did the user ask for fries with that?<br>if( http.doesFormParamExist( "fries" ) ) {<br>&nbsp;&nbsp;&nbsp;# Do something<br>}</pre><b>See also:</b> <a href="./http.html#http.getFormParam">http.getFormParam</a>, <a href="./http.html#http.listFormParamNames">http.listFormParamNames</a>, <a href="./http.html#http.getFormParams">http.getFormParams</a></div>
      </div>

      <div class="functionDoc" id="http.getBody">
         <h4>http.getBody( [count] )</h4>
         <div class="functionDescription"><p>
Returns the body data of the request. HTTP clients use the body data for sending file uploads or for HTML form parameters. <br/> If the optional 'count' parameter is supplied, http.getBody() will only read and return this number of bytes.  If count is 0, http.getBody() returns the entire request. <br/> If the request has no body, then this returns an empty string. <br/> http.getBody() will work in a response rule only if the entire request was read before the request rules completed (for example, if another call to http.getBody() was made in a request rule). Otherwise, request data will have been streamed to the server and not cached. If the request data is not available, this function will return the empty string. <br/> This function is not usable in response rules, as the body data of the request will no longer be accessible. <br/> To read HTML form parameters, it is easier to use http.getFormParam() as that will work for GET and POST requests.
</p><pre># Read the entire request body<br>$body = http.getBody();</pre><b>See also:</b> <a href="./http.html#http.getBodyLines">http.getBodyLines</a>, <a href="./http.html#http.setBody">http.setBody</a>, <a href="./http.html#http.getResponseBody">http.getResponseBody</a>, <a href="./http.html#http.getFormParams">http.getFormParams</a>, <a href="./http.html#http.listFormParamNames">http.listFormParamNames</a></div>
      </div>

      <div class="functionDoc" id="http.getBodyLines">
         <h4>http.getBodyLines( [count] )</h4>
         <div class="functionDescription"><p>
Splits the body data of the HTTP request into individual lines and returns an array of the data. <br/> If the optional 'count' parameter is supplied, http.getBodyLines() will only read and return this number of bytes.  If count is 0, http.getBodyLines() returns the entire request. <br/> If the request has no body, then this returns an empty array. This function is not usable in response rules, as the body data of the request will no longer be accessible. <br/> To read HTML form parameters, it is easier to use http.getFormParams() as that will work for GET and POST requests.
</p><pre># Read the entire request body<br>$body = http.getBodyLines();<br><br># If the body data is some special format we can<br>#  understand then we can process it line-by-line<br>if( array.length( $body ) > 0 ) {<br>&nbsp;&nbsp;&nbsp;if( array.shift( $body ) == "Special data" ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach( $line in $body ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# handle special body data lines<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;}<br>}</pre><b>See also:</b> <a href="./http.html#http.getBody">http.getBody</a>, <a href="./http.html#http.getResponseBodyLines">http.getResponseBodyLines</a></div>
      </div>

      <div class="functionDoc" id="http.getCookie">
         <h4>http.getCookie( name )</h4>
         <div class="functionDescription"><p>
Returns the named cookie in the incoming HTTP request. <br/> http.getCookie is a helper method that makes it easier to parse the HTTP Cookie header and extract the values of that particular cookie, rather than using http.getHeader() directly. <br/> An HTTP 'Cookie' header can have multiple values, such as <br/> &nbsp;&nbsp;Cookie: user-id=Joe; user-type=gold <br/> http.getCookie( ... ) will retrieve the 'Cookie' header line and parse it, returning the value of the cookie. If the cookie does not exist, http.getCookie() will return the empty string.
</p><pre># Get the PHP session cookie<br>$cookie = http.getCookie( "PHPSESSIONID" );</pre><b>See also:</b> <a href="./http.html#http.getCookies">http.getCookies</a>, <a href="./http.html#http.setCookie">http.setCookie</a>, <a href="./http.html#http.removeCookie">http.removeCookie</a>, <a href="./http.html#http.getResponseCookie">http.getResponseCookie</a></div>
      </div>

      <div class="functionDoc" id="http.getCookies">
         <h4>http.getCookies(  )</h4>
         <div class="functionDescription"><p>
Returns a hash containing the names of all the cookies in this request mapped to their values. <br/> An HTTP 'Cookie' header can have multiple values, such as <br/> &nbsp;&nbsp;Cookie: user-id=Joe; user-type=gold <br/> http.getCookies() will retrieve the 'Cookie' header line and parse it, returning a hash mapping all the cookie names to their values.
</p><pre># List all of the cookie names and their values<br>$cookies = http.getCookies();<br>foreach( $cookie in hash.keys( $cookies ) ) {<br>&nbsp;&nbsp;&nbsp;log.info( $cookie . ": " . $cookies[$cookie] );<br>}</pre><b>See also:</b> <a href="./http.html#http.getCookie">http.getCookie</a>, <a href="./http.html#http.setCookie">http.setCookie</a>, <a href="./http.html#http.removeCookie">http.removeCookie</a>, <a href="./http.html#http.getResponseCookies">http.getResponseCookies</a></div>
      </div>

      <div class="functionDoc" id="http.getFormParam">
         <h4>http.getFormParam( Parameter, [Separator] )</h4>
         <div class="functionDescription"><p>
Returns the %-decoded form parameter from the URL query string, or if not found and the request is a POST, from the POST body data. <br/>  If the parameter is provided twice, only the first will be returned, unless the optional separator is provided, in which case all matches will be returned, separated with this string.
</p><pre># See what drink the user wanted<br>$drink = http.getFormParam( "drink" );</pre><b>See also:</b> <a href="./http.html#http.setQueryString">http.setQueryString</a>, <a href="./http.html#http.getRawURL">http.getRawURL</a>, <a href="./http.html#http.getBody">http.getBody</a>, <a href="./http.html#http.listFormParamNames">http.listFormParamNames</a>, <a href="./http.html#http.getFormParams">http.getFormParams</a></div>
      </div>

      <div class="functionDoc" id="http.getFormParamNames">
         <h4>http.getFormParamNames( Separator )</h4>
         <div class="functionDescription"><p>
Returns a list containing the names of all the form parameters present in the URL query string and, if the request is a POST, in the POST body data.  The names are returned as a single string, separated by the string supplied to this function.  If the same parameter appears multiple times in the request, it will only appear once in the list returned by this function.
</p><p>This function has been deprecated; </div>
      </div>

      <div class="functionDoc" id="http.getFormParams">
         <h4>http.getFormParams(  )</h4>
         <div class="functionDescription"><p>
Returns a hash mapping the names of all the form parameters present in the URL query string and, if the request is a POST, in the POST body data to their values.  If the same parameter appears multiple times in the request then it will be mapped to an array of values in the hash that is returned by this function.
</p><pre># Log all of the form parameters and values<br>$params = http.getFormParams();<br>foreach( $param in hash.keys( $params ) ) {<br>&nbsp;&nbsp;&nbsp;$values = $params[$param];<br>&nbsp;&nbsp;&nbsp;if( lang.isArray( $values ) ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.info($param . "=" .<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array.join( $values, ", " )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br>&nbsp;&nbsp;&nbsp;} else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.info($param . "=" . $values);<br>&nbsp;&nbsp;&nbsp;}<br>}</pre><b>See also:</b> <a href="./http.html#http.getFormParam">http.getFormParam</a>, <a href="./http.html#http.doesFormParamExist">http.doesFormParamExist</a>, <a href="./http.html#http.listFormParamNames">http.listFormParamNames</a></div>
      </div>

      <div class="functionDoc" id="http.getHeader">
         <h4>http.getHeader( name )</h4>
         <div class="functionDescription"><p>
Returns the value of a named HTTP header in the HTTP request, or the empty string if the header does not exist or has an empty value. The lookup is case-insensitive.
</p><pre># Get the browser name and version<br>$browser = http.getHeader( "User-Agent" );<br><br># this returns the same value<br>$browser = http.getHeader( "user-agent" );</pre><b>See also:</b> <a href="./http.html#http.getHeaders">http.getHeaders</a>, <a href="./http.html#http.setHeader">http.setHeader</a>, <a href="./http.html#http.addHeader">http.addHeader</a>, <a href="./http.html#http.removeHeader">http.removeHeader</a>, <a href="./http.html#http.headerExists">http.headerExists</a>, <a href="./http.html#http.getResponseHeader">http.getResponseHeader</a>, <a href="./http.html#http.getHostHeader">http.getHostHeader</a>, <a href="./http.html#http.getHeaders">http.getHeaders</a></div>
      </div>

      <div class="functionDoc" id="http.getHeaderNames">
         <h4>http.getHeaderNames(  )</h4>
         <div class="functionDescription"><p>
Returns a list of all the headers that are present in the request. <br/> The headers are returned as a single string, separated by spaces.
</p><p>This function has been deprecated; </div>
      </div>

      <div class="functionDoc" id="http.getHeaders">
         <h4>http.getHeaders(  )</h4>
         <div class="functionDescription"><p>
Returns a hash containing all the header names in the request mapped to their values.
</p><pre># Show all the headers in the request<br>$headers = http.getHeaders();<br><br>foreach( $header in hash.keys( $headers ) ) {<br>&nbsp;&nbsp;&nbsp;log.info( $header . "=" . $headers[$header] );<br>}</pre><b>See also:</b> <a href="./http.html#http.getHeader">http.getHeader</a>, <a href="./http.html#http.setHeader">http.setHeader</a>, <a href="./http.html#http.addHeader">http.addHeader</a>, <a href="./http.html#http.removeHeader">http.removeHeader</a>, <a href="./http.html#http.headerExists">http.headerExists</a>, <a href="./http.html#http.getResponseHeaders">http.getResponseHeaders</a>, <a href="./http.html#http.getHostHeader">http.getHostHeader</a></div>
      </div>

      <div class="functionDoc" id="http.getHostHeader">
         <h4>http.getHostHeader(  )</h4>
         <div class="functionDescription"><p>
Returns the HTTP Host header. This value is lowercased and has the port removed. Any trailing full stop is also removed.  For example if the Host header is 'www.Brocade.com:80' then http.getHostHeader() returns 'www.brocade.com'.
</p><pre># Get the unambiguous Host header<br>$hostheader = http.getHostHeader();</pre><b>See also:</b> <a href="./http.html#http.getHeader">http.getHeader</a></div>
      </div>

      <div class="functionDoc" id="http.getMethod">
         <h4>http.getMethod(  )</h4>
         <div class="functionDescription"><p>
Returns the HTTP method that was used to make the request, such as GET or POST.
</p><pre># Was this an HTTP POST?<br>if( http.getMethod() == "POST" ) {<br>&nbsp;&nbsp;&nbsp;# handle POST request ...<br>}</pre><b>See also:</b> <a href="./http.html#http.setMethod">http.setMethod</a></div>
      </div>

      <div class="functionDoc" id="http.getMultipartAttachment">
         <h4>http.getMultipartAttachment( part )</h4>
         <div class="functionDescription"><p>
Returns the specified data out of a multipart encoded HTTP request.  The data contained in the part is returned on success, or "" if it doesn't exist for that part. $1 contains the Content Type of the part, and $2 contains the complete headers for that part.
</p><pre>$count = 0;<br>while( $data =<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http.getMultipartAttachment( $count ) ) {<br>&nbsp;&nbsp;log.info( "Data was " . $data );<br>&nbsp;&nbsp;log.info( "Content-Type was " . $1 );<br>&nbsp;&nbsp;log.info( "Headers were " . $2 );<br>&nbsp;&nbsp;$count = $count + 1;<br>}</pre></div>
      </div>

      <div class="functionDoc" id="http.getPath">
         <h4>http.getPath(  )</h4>
         <div class="functionDescription"><p>
Returns the %-decoded path in the HTTP request URL, stripping the query string if one was provided. If there is a leading scheme and authority prefix, this is removed as well, so the URL "http://www.example.com/content?page=44" will be returned as "/content".
</p><pre># Retrieve the path<br>$path = http.getPath();</pre><b>See also:</b> <a href="./http.html#http.setPath">http.setPath</a>, <a href="./http.html#http.getRawURL">http.getRawURL</a>, <a href="./http.html#http.getQueryString">http.getQueryString</a>, <a href="./http.html#http.getRawQueryString">http.getRawQueryString</a>, <a href="./http.html#http.normalizePath">http.normalizePath</a></div>
      </div>

      <div class="functionDoc" id="http.getQueryString">
         <h4>http.getQueryString(  )</h4>
         <div class="functionDescription"><p>
Returns the %-decoded query string in the URL, or the empty string if no query string was provided.
</p><pre># Was there a query string?<br>$qs = http.getQueryString();<br>if( $qs ) {<br>&nbsp;&nbsp;&nbsp;# Handle query string ...<br>}</pre><b>See also:</b> <a href="./http.html#http.setQueryString">http.setQueryString</a>, <a href="./http.html#http.getRawQueryString">http.getRawQueryString</a>, <a href="./http.html#http.setRawQueryString">http.setRawQueryString</a>, <a href="./http.html#http.getRawURL">http.getRawURL</a></div>
      </div>

      <div class="functionDoc" id="http.getRawQueryString">
         <h4>http.getRawQueryString(  )</h4>
         <div class="functionDescription"><p>
Returns the raw (non %-decoded) query string in the URL, or the empty string if no query string was provided.
</p><pre># Was there a query string?<br>$qs = http.getRawQueryString();<br>if( $qs ) {<br>&nbsp;&nbsp;&nbsp;# Handle query string ...<br>}</pre><b>See also:</b> <a href="./http.html#http.setRawQueryString">http.setRawQueryString</a>, <a href="./http.html#http.getQueryString">http.getQueryString</a>, <a href="./http.html#http.setQueryString">http.setQueryString</a>, <a href="./http.html#http.getRawURL">http.getRawURL</a></div>
      </div>

      <div class="functionDoc" id="http.getRawURL">
         <h4>http.getRawURL(  )</h4>
         <div class="functionDescription"><p>
Returns the raw (non-decoded) URL data provided by the client in the first line of the HTTP request, after the method and before the HTTP version specifier. <br/> The raw URL data includes both the path and query string if supplied and is not decoded. It may also contain the protocol and hostname if the client sent them.  It could contain %-escaped characters that can be used to disguise the contents of the URL. Use http.getPath() or http.getQueryString() to return the %-decoded version of the path or query string. <br/> This function could return raw urls of various forms including: <ul> <li>http://www.example.com/file.html</li> <li>/file.html</li> <li>/path/../file.html</li> <li>/file.html?querystring</li> <li>/file.html?qs%encoded</li> </ul><br/> You can use http.normalizePath() on the path component to remove any '/../' or '/./' references. <br/> In general it is better to use http.getPath() and http.getQueryString() to avoid the need to process the raw url.
</p><pre>$rawurl = http.getRawURL();<br>if( string.contains( $rawurl, "%00" ) ) {<br>&nbsp;&nbsp;&nbsp;# Something suspicious here ...<br>&nbsp;&nbsp;&nbsp;connection.discard();<br>}</pre><b>See also:</b> <a href="./http.html#http.getPath">http.getPath</a>, <a href="./http.html#http.getQueryString">http.getQueryString</a>, <a href="./http.html#http.getRawQueryString">http.getRawQueryString</a>, <a href="./string.html#string.unescape">string.unescape</a>, <a href="./http.html#http.normalizePath">http.normalizePath</a></div>
      </div>

      <div class="functionDoc" id="http.getRequest">
         <h4>http.getRequest(  )</h4>
         <div class="functionDescription"><p>
Returns the full HTTP request and headers, but does not include any body data.
</p><pre># Check that the request is not too big<br># for our servers<br>$request = http.getRequest();<br>if( string.len( $request ) > 2048 ) {<br>&nbsp;&nbsp;&nbsp;http.sendResponse( "413 Request too large",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"text/plain",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Request too large", "" );<br>}</pre><b>See also:</b> <a href="./http.html#http.listHeaderNames">http.listHeaderNames</a>, <a href="./http.html#http.getHeader">http.getHeader</a>, <a href="./http.html#http.getBody">http.getBody</a></div>
      </div>

      <div class="functionDoc" id="http.getResponse">
         <h4>http.getResponse(  )</h4>
         <div class="functionDescription"><p>
Returns the beginning of the HTTP response (the status line and the headers), up to but not including the empty line that separates the headers from the body. The returned string does not include any body data.
</p><pre># See if the response included any<br># headers that start with 'Foo'<br>$response = http.getResponse();<br>if( string.regexMatch( $response, "^Foo" )) {<br>&nbsp;&nbsp;&nbsp;log.info( "A 'Foo' header was found" );<br>}</pre><b>See also:</b> <a href="./http.html#http.listResponseHeaderNames">http.listResponseHeaderNames</a>, <a href="./http.html#http.getResponseHeader">http.getResponseHeader</a>, <a href="./http.html#http.getResponseBody">http.getResponseBody</a></div>
      </div>

      <div class="functionDoc" id="http.getResponseBody">
         <h4>http.getResponseBody( [count] )</h4>
         <div class="functionDescription"><p>
Returns the body of the HTTP response. <br/> If the response has chunked transfer encoding this function will return the de-chunked body. Similarly if the response is gzip or deflate compressed the body will be returned uncompressed. <br/> If the optional 'count' parameter is provided, http.getResponseBody() will read and return the first 'count' bytes of the response.  If count is 0, http.getResponseBody() will return the entire response.
</p><pre># Read the entire response body<br>$body = http.getResponseBody();</pre><b>See also:</b> <a href="./http.html#http.setResponseBody">http.setResponseBody</a>, <a href="./http.html#http.getBody">http.getBody</a></div>
      </div>

      <div class="functionDoc" id="http.getResponseBodyLines">
         <h4>http.getResponseBodyLines( [count] )</h4>
         <div class="functionDescription"><p>
Splits the body data of the HTTP request into individual lines and returns an array of the data. <br/> If the response has chunked transfer encoding this function will return the de-chunked body. Similarly if the response is gzip or deflate compressed the body will be returned uncompressed. <br/> If the optional 'count' parameter is provided, http.getResponseBodyLines() will read and return the first 'count' bytes of the response.  If count is 0, http.getResponseBodyLines() will return the entire response.
</p><pre># Read the entire response body<br>$body = http.getResponseBodyLines();</pre><b>See also:</b> <a href="./http.html#http.setResponseBody">http.setResponseBody</a>, <a href="./http.html#http.getBodyLines">http.getBodyLines</a></div>
      </div>

      <div class="functionDoc" id="http.getResponseCode">
         <h4>http.getResponseCode(  )</h4>
         <div class="functionDescription"><p>
Returns the status code from the first line of the HTTP response.
</p><pre># Log 404 responses<br>if( http.getResponseCode() == 404 ) {<br>&nbsp;&nbsp;&nbsp;log.info( "404 page for " . http.getPath() );<br>}</pre><b>See also:</b> <a href="./http.html#http.setResponseCode">http.setResponseCode</a></div>
      </div>

      <div class="functionDoc" id="http.getResponseCookie">
         <h4>http.getResponseCookie( name )</h4>
         <div class="functionDescription"><p>
Returns the value of the named cookie in the HTTP response. <br/> http.getResponseCookie() is a helper method to make it easier to parse the HTTP Set-Cookie header and extract the values of that particular cookie, rather than using http.getResponseHeader() directly. <br/> If the cookie does not exist, http.getResponseCookie() will return the empty string. <br/> This function should be called in a response rule; it has no effect in a request rule.
</p><pre># Get the PHP session cookie<br>$cookie = http.getResponseCookie( "PHPSESSIONID" );</pre><b>See also:</b> <a href="./http.html#http.getResponseCookies">http.getResponseCookies</a>, <a href="./http.html#http.setResponseCookie">http.setResponseCookie</a>, <a href="./http.html#http.removeResponseCookie">http.removeResponseCookie</a>, <a href="./http.html#http.getCookie">http.getCookie</a></div>
      </div>

      <div class="functionDoc" id="http.getResponseCookies">
         <h4>http.getResponseCookies(  )</h4>
         <div class="functionDescription"><p>
Returns a hash containing the names of all the cookies being set in this response, mapped to their values. <br/> This function should be called in a response rule; it has no effect in a request rule.
</p><pre># List all of the cookies that are being set in<br># the response and their values<br>$cookies = http.getResponseCookies();<br>foreach( $cookie in hash.keys( $cookies ) ) {<br>&nbsp;&nbsp;&nbsp;log.info( $cookie . ": " . $cookies[$cookie] );<br>}</pre><b>See also:</b> <a href="./http.html#http.getResponseCookie">http.getResponseCookie</a>, <a href="./http.html#http.setResponseCookie">http.setResponseCookie</a>, <a href="./http.html#http.removeResponseCookie">http.removeResponseCookie</a>, <a href="./http.html#http.getCookies">http.getCookies</a></div>
      </div>

      <div class="functionDoc" id="http.getResponseHeader">
         <h4>http.getResponseHeader( name )</h4>
         <div class="functionDescription"><p>
Returns the value of a named HTTP header in the HTTP response, or the empty string if the header does not exist or has an empty value. The header lookup is case-insensitive.
</p><pre># Get the mime type of the response<br>$mime = http.getResponseHeader( "Content-Type" );<br><br># note that the MIME type may look like<br># 'text/html; charset=ISO-8859-1'</pre><b>See also:</b> <a href="./http.html#http.setResponseHeader">http.setResponseHeader</a>, <a href="./http.html#http.addResponseHeader">http.addResponseHeader</a>, <a href="./http.html#http.removeResponseHeader">http.removeResponseHeader</a>, <a href="./http.html#http.responseHeaderExists">http.responseHeaderExists</a>, <a href="./http.html#http.getHeader">http.getHeader</a></div>
      </div>

      <div class="functionDoc" id="http.getResponseHeaderNames">
         <h4>http.getResponseHeaderNames(  )</h4>
         <div class="functionDescription"><p>
Returns a list of all the headers that are present in the response. <br/> The headers are returned as a single string, separated by spaces.
</p><p>This function has been deprecated; </div>
      </div>

      <div class="functionDoc" id="http.getResponseHeaders">
         <h4>http.getResponseHeaders(  )</h4>
         <div class="functionDescription"><p>
Returns a hash containing all the header names in the response mapped to their values.
</p><pre># Show all the headers in the response<br>$headers = http.getResponseHeaders();<br><br>foreach( $header in hash.keys( $headers ) ) {<br>&nbsp;&nbsp;&nbsp;log.info( $header . "=" . $headers[$header] );<br>}</pre><b>See also:</b> <a href="./http.html#http.getResponseHeader">http.getResponseHeader</a>, <a href="./http.html#http.setResponseHeader">http.setResponseHeader</a>, <a href="./http.html#http.addResponseHeader">http.addResponseHeader</a>, <a href="./http.html#http.removeResponseHeader">http.removeResponseHeader</a>, <a href="./http.html#http.responseHeaderExists">http.responseHeaderExists</a>, <a href="./http.html#http.getHeaders">http.getHeaders</a></div>
      </div>

      <div class="functionDoc" id="http.getResponseVersion">
         <h4>http.getResponseVersion(  )</h4>
         <div class="functionDescription"><p>
Returns the version of the HTTP protocol being used. It returns the version string in the first line of the HTTP response, such as 'HTTP/1.1'. It will return the empty string in the case of HTTP/0.9 response.
</p><pre># Get the HTTP response version<br>$version = http.getResponseVersion();</pre><b>See also:</b> <a href="./http.html#http.getVersion">http.getVersion</a></div>
      </div>

      <div class="functionDoc" id="http.getVersion">
         <h4>http.getVersion(  )</h4>
         <div class="functionDescription"><p>
Returns the version of the HTTP protocol being used. It returns the version string in the first line of the HTTP request, such as "HTTP/1.1". It will return the empty string in the case of HTTP/0.9, which does not have a version specifier in the request.
</p><pre># Get the HTTP version<br>$version = http.getVersion();</pre><b>See also:</b> <a href="./http.html#http.getResponseVersion">http.getResponseVersion</a></div>
      </div>

      <div class="functionDoc" id="http.headerExists">
         <h4>http.headerExists( name )</h4>
         <div class="functionDescription"><p>
Reports if a named header exists or not. It is similar to http.getHeader(), but makes it possible to distinguish between a header not being present and a header having no value.  <br/>  The lookup is case-insensitive. <br/>  It returns 1 if the header exists, and 0 if it does not.
</p><pre># Add a host header if it is missing<br>if( !http.headerExists( "Host" ) ) {<br>&nbsp;&nbsp;&nbsp;http.addheader( "Host", "unknown" );<br>}</pre><b>See also:</b> <a href="./http.html#http.getHeader">http.getHeader</a></div>
      </div>

      <div class="functionDoc" id="http.listFormParamNames">
         <h4>http.listFormParamNames(  )</h4>
         <div class="functionDescription"><p>
Returns an array containing the names of all the form parameters present in the URL query string and, if the request is a POST, in the POST body data.  If the same parameter appears multiple times in the request, it will only appear once in the list returned by this function.
</p><pre># Log all of the form parameters and values<br>$params = http.listFormParamNames();<br>foreach( $param in $params ) {<br>&nbsp;&nbsp;&nbsp;log.info($param . "=" .<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http.getFormParam($param, ","));<br>}</pre><b>See also:</b> <a href="./http.html#http.getFormParam">http.getFormParam</a>, <a href="./http.html#http.doesFormParamExist">http.doesFormParamExist</a></div>
      </div>

      <div class="functionDoc" id="http.listHeaderNames">
         <h4>http.listHeaderNames(  )</h4>
         <div class="functionDescription"><p>
Returns a list of all the headers that are present in the request. <br/> The headers are returned as an array.
</p><pre># Log all of the header names and values<br>$headers = http.listHeaderNames();<br>foreach( $header in $headers ) {<br>&nbsp;&nbsp;&nbsp;log.info($header . "=" . http.getHeader($header));<br>}</pre><b>See also:</b> <a href="./http.html#http.getHeader">http.getHeader</a>, <a href="./http.html#http.removeHeader">http.removeHeader</a>, <a href="./http.html#http.getRequest">http.getRequest</a>, <a href="./http.html#http.listResponseHeaderNames">http.listResponseHeaderNames</a></div>
      </div>

      <div class="functionDoc" id="http.listResponseHeaderNames">
         <h4>http.listResponseHeaderNames(  )</h4>
         <div class="functionDescription"><p>
Returns a list of all the headers that are present in the response. <br/> The headers are returned as an array.
</p><pre># Log all of the header names and values<br>$headers = http.listResponseHeaderNames();<br>foreach( $header in $headers ) {<br>&nbsp;&nbsp;&nbsp;log.info($header . "=" . http.getHeader($header));<br>}</pre><b>See also:</b> <a href="./http.html#http.getResponseHeader">http.getResponseHeader</a>, <a href="./http.html#http.removeResponseHeader">http.removeResponseHeader</a>, <a href="./http.html#http.getResponse">http.getResponse</a>, <a href="./http.html#http.listHeaderNames">http.listHeaderNames</a></div>
      </div>

      <div class="functionDoc" id="http.normalizePath">
         <h4>http.normalizePath( url )</h4>
         <div class="functionDescription"><p>
Flattens a decoded URL path, converting '//' to '/', '/./' to '/', and flattening '/a/../' to '/'. It returns the flattened path string. <br/> If the file system path is invalid, this function returns the empty string. Invalid paths include those that contain disallowed characters like '\0', invalid hex-escapes, or that use '../' sequences to reference a location outside the local root. <br/> This function should be used on the retrieved URL before attempting path matching for access control. Remember to pass in a %-decoded URL path, to prevent disguised paths and control codes from being 'hidden' in the path.
</p><pre># Check for access to /secure<br>$path = http.normalizePath( http.getPath() );<br>if( !$path ) {<br>&nbsp;&nbsp;&nbsp;# bad path ...<br>} else if( string.startsWith( $path, "/secure" ) ) {<br>&nbsp;&nbsp;&nbsp;# request to restricted area: check credentials<br>}</pre><b>See also:</b> <a href="./http.html#http.getPath">http.getPath</a></div>
      </div>

      <div class="functionDoc" id="http.redirect">
         <h4>http.redirect( address )</h4>
         <div class="functionDescription"><p>
Sends back a HTTP 302 redirect response, which will send a web browser to a different URL. This is equivalent to http.sendResponse( "302 Moved Temporarily", "text/html", "",                    "Location: " . $url );
</p><pre># Redirect all 404 error pages to our front page<br>if( http.getResponseCode() == 404 ) {<br>&nbsp;&nbsp;&nbsp;http.redirect( "http://www.brocade.com/" );<br>}</pre><b>See also:</b> <a href="./http.html#http.sendResponse">http.sendResponse</a>, <a href="./http.html#http.changeSite">http.changeSite</a></div>
      </div>

      <div class="functionDoc" id="http.removeCookie">
         <h4>http.removeCookie( name )</h4>
         <div class="functionDescription"><p>
Removes the named cookie from the incoming HTTP request. <br/> http.removeCookie is a helper method that makes it easier to parse the HTTP Cookie header and remove a particular cookie, rather than using http.getHeader() and http.setHeader() directly.
</p><pre># Remove the 'Priority' cookie<br>http.removeCookie( "Priority" );</pre><b>See also:</b> <a href="./http.html#http.getCookie">http.getCookie</a>, <a href="./http.html#http.setCookie">http.setCookie</a>, <a href="./http.html#http.removeResponseCookie">http.removeResponseCookie</a></div>
      </div>

      <div class="functionDoc" id="http.removeHeader">
         <h4>http.removeHeader( name )</h4>
         <div class="functionDescription"><p>
Removes a named header if it exists in the request.
</p><pre># Remove the 'Accept-Language' header if it exists<br>http.removeHeader( "Accept-Language" );</pre><b>See also:</b> <a href="./http.html#http.getHeader">http.getHeader</a>, <a href="./http.html#http.addHeader">http.addHeader</a>, <a href="./http.html#http.setHeader">http.setHeader</a>, <a href="./http.html#http.removeResponseHeader">http.removeResponseHeader</a></div>
      </div>

      <div class="functionDoc" id="http.removeResponseCookie">
         <h4>http.removeResponseCookie( name )</h4>
         <div class="functionDescription"><p>
Removes a cookie from the HTTP response. <br/> This function should be called in a response rule; it has no effect in a request rule.
</p><pre># Remove the 'Priority' cookie<br>http.removeResponseCookie( "Priority" );</pre><b>See also:</b> <a href="./http.html#http.getResponseCookie">http.getResponseCookie</a>, <a href="./http.html#http.setResponseCookie">http.setResponseCookie</a>, <a href="./http.html#http.removeCookie">http.removeCookie</a></div>
      </div>

      <div class="functionDoc" id="http.removeResponseHeader">
         <h4>http.removeResponseHeader( name )</h4>
         <div class="functionDescription"><p>
Removes the named HTTP header from the HTTP response. The header lookup  is case-insensitive.
</p><pre># Remove the 'Location' response header<br>http.removeResponseHeader( "Location" );</pre><b>See also:</b> <a href="./http.html#http.setResponseHeader">http.setResponseHeader</a>, <a href="./http.html#http.getResponseHeader">http.getResponseHeader</a>, <a href="./http.html#http.addResponseHeader">http.addResponseHeader</a>, <a href="./http.html#http.scrubResponseHeaders">http.scrubResponseHeaders</a>, <a href="./http.html#http.removeHeader">http.removeHeader</a></div>
      </div>

      <div class="functionDoc" id="http.responseHeaderExists">
         <h4>http.responseHeaderExists( name )</h4>
         <div class="functionDescription"><p>
Reports if a named header exists in the HTTP response. It is similar to http.getResponseHeader(), but makes it possible to distinguish between a header not being present and a header having no value. <br/> Header lookups are case-insensitive. <br/> It returns 1 if the header exists, and 0 if it does not.
</p><pre>if( http.responseHeaderExists( "Location" ) ) {<br>&nbsp;&nbsp;&nbsp;# Web server is redirecting user to<br>&nbsp;&nbsp;&nbsp;# another location<br>}</pre><b>See also:</b> <a href="./http.html#http.getResponseHeader">http.getResponseHeader</a></div>
      </div>

      <div class="functionDoc" id="http.scrubRequestHeaders">
         <h4>http.scrubRequestHeaders( header1, header2, ... )</h4>
         <div class="functionDescription"><p>
Limits the allowed HTTP request headers to a known set. The allowed headers can either be passed in as a list or space separated in a single argument. <br/> Care should be taken when using this function to ensure that the headers that are required for connection handling are let through. At the very least, the following should be allowed: <blockquote>   <tt>Connection</tt>, <tt>Content-Length</tt>, <tt>Transfer-Encoding</tt>, <tt>Content-Type</tt>, <tt>Host</tt> </blockquote> For a complete list of HTTP headers, refer to RFC2616. Protocols that extend HTTP, such as WebDAV, use other headers.
</p><pre># Remove all headers, except the Connection,<br># Content-Type, Transfer-Encoding, Content-Length<br># and Host headers.<br><br># These 2 examples are identical<br><br>http.scrubRequestHeaders( "Host",<br>&nbsp;&nbsp;&nbsp;"Connection", "Content-Type",<br>&nbsp;&nbsp;&nbsp;"Transfer-Encoding", "Content-Length" );<br><br>http.scrubRequestHeaders(<br>&nbsp;&nbsp;&nbsp;"host connection content-type transfer-encoding".<br>&nbsp;&nbsp;&nbsp;" content-length" );</pre><b>See also:</b> <a href="./http.html#http.removeHeader">http.removeHeader</a>, <a href="./http.html#http.scrubResponseHeaders">http.scrubResponseHeaders</a></div>
      </div>

      <div class="functionDoc" id="http.scrubResponseHeaders">
         <h4>http.scrubResponseHeaders( header1, header2, ... )</h4>
         <div class="functionDescription"><p>
Limits the allowed HTTP response headers to a known set. The allowed headers can either be passed in as a list or space separated in a single argument. <br/> Care should be taken when using this function to ensure that the headers that are required for connection handling are let through. At the very least, the following should be allowed: <blockquote>   <tt>Connection</tt>, <tt>Content-Length</tt>, <tt>Transfer-Encoding</tt>, <tt>Location</tt> </blockquote> For a complete list of HTTP headers, refer to RFC2616. Protocols that extend HTTP, such as WebDAV, use other headers.
</p><pre># Remove all headers, except the Date, Connection,<br># Content-Type, Transfer-Encoding, Content-Length<br># and Location headers.<br><br># These 2 examples are identical<br><br>http.scrubResponseHeaders( "Date",<br>&nbsp;&nbsp;&nbsp;"Connection", "Content-Type",<br>&nbsp;&nbsp;&nbsp;"Transfer-Encoding", "Content-Length",<br>&nbsp;&nbsp;&nbsp;"Location" );<br><br>http.scrubResponseHeaders(<br>&nbsp;&nbsp;&nbsp;"date connection content-type transfer-encoding".<br>&nbsp;&nbsp;&nbsp;" content-length location" );</pre><b>See also:</b> <a href="./http.html#http.removeResponseHeader">http.removeResponseHeader</a>, <a href="./http.html#http.scrubRequestHeaders">http.scrubRequestHeaders</a></div>
      </div>

      <div class="functionDoc" id="http.sendResponse">
         <h4>http.sendResponse( code, type, body, headers )</h4>
         <div class="functionDescription"><p>
Hands back an HTTP response to the client instead of balancing the request via a pool onto a node. It generates a correct HTTP response from the response code, content type, body data and headers supplied.  Multiple headers should be separated with \r\n (note, however, that your traffic manager may override some of these headers, e.g. the 'Connection' header).
</p><pre># Deny access and close connection<br>http.sendResponse( "403 Permission Denied",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"text/html", "Go away",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Set-Cookie: denied=Yes\r\nX-Foo: Bar");</pre><b>See also:</b> <a href="./connection.html#connection.close">connection.close</a>, <a href="./connection.html#connection.discard">connection.discard</a></div>
      </div>

      <div class="functionDoc" id="http.setBody">
         <h4>http.setBody( body )</h4>
         <div class="functionDescription"><p>
Sets the request body for this HTTP request to the supplied string, replacing any request body already present. <br/> This also updates the 'Content-Length' header in the request to the length of the new body data.
</p><pre># Change the order!<br>$body = http.getBody();<br>$body = string.regexsub( $body, "Buy", "Sell", "g" );<br>http.setBody( $body );</pre><b>See also:</b> <a href="./http.html#http.getBody">http.getBody</a>, <a href="./http.html#http.setResponseBody">http.setResponseBody</a></div>
      </div>

      <div class="functionDoc" id="http.setCookie">
         <h4>http.setCookie( name, value )</h4>
         <div class="functionDescription"><p>
Sets the value of the named cookie in the incoming HTTP request. <br/> http.setCookie is a helper method that makes it easier to parse the HTTP Cookie header and set the value of a particular cookie, rather than using http.getHeader() and http.setHeader() directly. <br/> An HTTP 'Cookie' header can have multiple values, such as <br/> &nbsp;&nbsp;Cookie: user-id=Joe; user-type=gold
</p><pre># Set the priority cookie<br>http.setCookie( "Priority", "Gold" );</pre><b>See also:</b> <a href="./http.html#http.getCookie">http.getCookie</a>, <a href="./http.html#http.removeCookie">http.removeCookie</a>, <a href="./http.html#http.setResponseCookie">http.setResponseCookie</a></div>
      </div>

      <div class="functionDoc" id="http.setEscapedPath">
         <h4>http.setEscapedPath( url )</h4>
         <div class="functionDescription"><p>
Replaces the path portion of the request URL with the supplied value. If the replacement value contains a '?', this function will also replace the query string; otherwise, any query string is preserved. Characters  whose ASCII value is less than or equal to 32 and '%' will be %-encoded in the replacement value.
</p><pre># Make customer buy widget:<br>http.setEscapedPath( "/purchase?product=widget" );</pre><b>See also:</b> <a href="./http.html#http.getPath">http.getPath</a>, <a href="./http.html#http.setPath">http.setPath</a>, <a href="./http.html#http.setRawPath">http.setRawPath</a></div>
      </div>

      <div class="functionDoc" id="http.setHeader">
         <h4>http.setHeader( name, value )</h4>
         <div class="functionDescription"><p>
Sets the value of the named HTTP header. <br/> A case-insensitive lookup is first performed in order  to identify any existing headers, replacing the value  where a match is found.  <br/> Note that the "Connection" header is manipulated by your traffic manager and that changing its value in TrafficScript may not give the expected results.
</p><pre># Add (or replace) an X-Forwarded-By header<br>http.setHeader( "X-Forwarded-By",<br>&nbsp;&nbsp;&nbsp;"Stingray " . sys.hostname() );</pre><b>See also:</b> <a href="./http.html#http.addHeader">http.addHeader</a>, <a href="./http.html#http.getHeader">http.getHeader</a>, <a href="./http.html#http.headerExists">http.headerExists</a>, <a href="./http.html#http.removeHeader">http.removeHeader</a>, <a href="./http.html#http.setResponseHeader">http.setResponseHeader</a></div>
      </div>

      <div class="functionDoc" id="http.setIdempotent">
         <h4>http.setIdempotent( resend )</h4>
         <div class="functionDescription"><p>
Marks a request as resendable or non-resendable. <br/> An <i>idempotent</i> request has no detrimental side effects, so it can safely be submitted multiple times. A simple page retrieval is generally idempotent. A non-idempotent request has a side effect - for example, it may update a database, or initiate a purchase. The HTTP/1.1 specification regards all GET, HEAD, PUT, DELETE, OPTIONS and TRACE requests as idempotent. <br/> Your traffic manager tags these requests as 'resendable'; if the request is submitted to a back-end node and a correct response is not received, your traffic manager will resubmit the request to another back-end node. All other requests, such as POST requests are not resent if a back-end node fails to generate a correct response. <br/> http.setIdempotent() can override this behaviour. If 'resend' has a non-zero value, this indicates that if the request is submitted to a back-end node and a correct response is not received, your traffic manager should resubmit the request to another back-end node. <br/> If 'resend' is zero, this indicates that the request should only be attempted against one back-end node. <br/> Note that a request cannot be resent if it has begun streaming data from the client to the node before it detects the failure.  To avoid this, you can read the entire request within the TrafficScript rule, so that it is buffered in its entirety internally in the TrafficManager.
</p><pre># This request can be resent<br>if( http.getMethod() == "POST" ) {<br>&nbsp;&nbsp;&nbsp;# Force the Stingray Traffic Manager<br>&nbsp;&nbsp;&nbsp;# to read the entire HTTP body<br>&nbsp;&nbsp;&nbsp;http.getBody();<br>&nbsp;&nbsp;&nbsp;# Mark this request as resendable<br>&nbsp;&nbsp;&nbsp;http.setIdempotent( 1 );<br>}</pre><b>See also:</b> <a href="./request.html#request.setIdempotent">request.setIdempotent</a></div>
      </div>

      <div class="functionDoc" id="http.setMethod">
         <h4>http.setMethod( method )</h4>
         <div class="functionDescription"><p>
Sets the HTTP method, changing the original request.
</p><pre># Force HTTP POSTs to GETs<br>if( http.getMethod() == "POST" ) {<br>&nbsp;&nbsp;&nbsp;http.setBody( "" );<br>&nbsp;&nbsp;&nbsp;http.setMethod( "GET" );<br>}</pre><b>See also:</b> <a href="./http.html#http.getMethod">http.getMethod</a></div>
      </div>

      <div class="functionDoc" id="http.setPath">
         <h4>http.setPath( url )</h4>
         <div class="functionDescription"><p>
Replaces the path portion of the request URL with the supplied value. If the replacement value contains a '?', this function will also replace the query string; otherwise, any query string is preserved. This function will %-encode any character excluding following set as defined in RFC3986 - Unreserved: A-Z, a-z, 0-9, ., _, - - Reserved: !, *, (, ), ;, :, @, &, =, +,'              $, ',', ?, /, #, [, ] - '%'
</p><pre># Make customer buy widget:<br>http.setPath( "/purchase?product=widget" );</pre><b>See also:</b> <a href="./http.html#http.getPath">http.getPath</a>, <a href="./http.html#http.setRawPath">http.setRawPath</a>, <a href="./http.html#http.setEscapedPath">http.setEscapedPath</a>, <a href="./string.html#string.urlencode">string.urlencode</a></div>
      </div>

      <div class="functionDoc" id="http.setQueryString">
         <h4>http.setQueryString( querystring )</h4>
         <div class="functionDescription"><p>
Replaces the query-string portion of the request URL with the supplied replacement. Any control characters in the replacement are %-encoded.
</p><pre># Rewrite the query string<br>http.setQueryString( $newqs );</pre><b>See also:</b> <a href="./http.html#http.getQueryString">http.getQueryString</a>, <a href="./http.html#http.setRawQueryString">http.setRawQueryString</a>, <a href="./http.html#http.getRawQueryString">http.getRawQueryString</a></div>
      </div>

      <div class="functionDoc" id="http.setRawPath">
         <h4>http.setRawPath( url )</h4>
         <div class="functionDescription"><p>
Replaces the path portion of the request URL with the supplied value. If the replacement value contains a '?', this function will also replace the query string; otherwise, any query string is preserved. URL will not be %-encoded.
</p><pre># Make customer buy widget:<br>http.setRawPath( "/purchase?product=widget" );</pre><b>See also:</b> <a href="./http.html#http.getPath">http.getPath</a>, <a href="./http.html#http.setPath">http.setPath</a>, <a href="./http.html#http.setEscapedPath">http.setEscapedPath</a></div>
      </div>

      <div class="functionDoc" id="http.setRawQueryString">
         <h4>http.setRawQueryString( querystring )</h4>
         <div class="functionDescription"><p>
Replaces the query-string portion of the request URL with the supplied replacement. Unlike http.setQueryString, control characters are not encoded.
</p><pre># Rewrite the query string<br>http.setRawQueryString( "foo=%20bar" );</pre><b>See also:</b> <a href="./http.html#http.getRawQueryString">http.getRawQueryString</a>, <a href="./http.html#http.setQueryString">http.setQueryString</a>, <a href="./http.html#http.getQueryString">http.getQueryString</a></div>
      </div>

      <div class="functionDoc" id="http.setResponseBody">
         <h4>http.setResponseBody( body, [transfer-encoding] )</h4>
         <div class="functionDescription"><p>
Sets the response body for this HTTP response to the supplied string, replacing any response body already present. <br/> This also updates the 'Content-Length' header in the response to the length of the new body data. In addition the 'Content-Encoding' header is removed as we only ever set body data which is not encoded or compressed. If the server is still sending the original response body when this function is called, the connection to the server will be harmlessly dropped. <br/> The optional 'transfer-encoding' parameter indicates the encoding of the body data (for example, 'chunked').
</p><pre>$body = http.getResponseBody( 0 );<br>$body = string.regexsub( $body, "Buy", "Sell", "g" );<br>http.setResponseBody( $body );</pre><b>See also:</b> <a href="./http.html#http.getResponseBody">http.getResponseBody</a>, <a href="./http.html#http.setBody">http.setBody</a></div>
      </div>

      <div class="functionDoc" id="http.setResponseCode">
         <h4>http.setResponseCode( code, [message] )</h4>
         <div class="functionDescription"><p>
Sets the status code and message in the first line of the HTTP response.
</p><pre># Not enough credit!<br>http.setResponseCode( "402", "Payment required" );</pre><b>See also:</b> <a href="./http.html#http.getResponseCode">http.getResponseCode</a></div>
      </div>

      <div class="functionDoc" id="http.setResponseCookie">
         <h4>http.setResponseCookie( name, value, [options] )</h4>
         <div class="functionDescription"><p>
Sets a cookie in the HTTP response. If the named cookie already exists, this function replaces its value. <br/> The options are a semi-colon separated list of cookie options, such as "domain", "path", "expires" and "secure". <br/> If the named cookie exists and no 'options' are provided, the current options for the named cookie are preserved. <br/> This function may be called from a request rule or a response rule.
</p><pre># Set the priority cookie<br>http.setResponseCookie( "Priority", "Gold" );<br><br># Set a username cookie, with various options<br>http.setResponseCookie( "Username", "mork",<br>&nbsp;&nbsp;&nbsp;"domain=example.com; path=/cgi-bin" );</pre><b>See also:</b> <a href="./http.html#http.getResponseCookie">http.getResponseCookie</a>, <a href="./http.html#http.removeResponseCookie">http.removeResponseCookie</a>, <a href="./http.html#http.setCookie">http.setCookie</a></div>
      </div>

      <div class="functionDoc" id="http.setResponseHeader">
         <h4>http.setResponseHeader( name, value )</h4>
         <div class="functionDescription"><p>
Sets a HTTP header in the HTTP response that will be sent back to the client. If the header already exists in the response, then it will be replaced with this new value.  The header lookup is case-insensitive. <br/> Note that this function should not be used with the Connection header, i.e. setResponseHeader("Connection", value) since it may not give the expected results.
</p><pre># Change the server string<br>http.setResponseHeader( "Server",<br>&nbsp;&nbsp;&nbsp;"Stingray" );</pre><b>See also:</b> <a href="./http.html#http.addResponseHeader">http.addResponseHeader</a>, <a href="./http.html#http.getResponseHeader">http.getResponseHeader</a>, <a href="./http.html#http.removeResponseHeader">http.removeResponseHeader</a>, <a href="./http.html#http.setHeader">http.setHeader</a></div>
      </div>

   </body>
</html>
